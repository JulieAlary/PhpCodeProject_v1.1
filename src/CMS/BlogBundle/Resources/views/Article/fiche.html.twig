{% extends "CMSBlogBundle::layout.html.twig" %}


{% block title %}
    Lecture d'un article - {{ parent() }}
{% endblock %}

{% block cms_body %}

    {#On affiche tous les messages flash dont le nom est « info » #}
    {% for message in app.session.flashbag.get('info') %}
        <div class="alert alert-info">Message flash : {{ message }}</div>
    {% endfor %}


    {% if article.published == true or is_granted('ROLE_AUTEUR') %}
        <div style="float: left; margin-right: 1em;">
            {% if article.image is not null %}
                <a href="{{ asset(article.image.uploadDir ~ '/' ~ article.image.id ~ '.' ~ article.image.url) }}"
                   alt="{{ article.image.alt }}"
                   class="html5lightbox"><img
                            src="{{ asset(article.image.uploadDir ~ '/' ~ article.image.id ~ '.' ~ article.image.url) }}"
                            alt="{{ article.image.alt }}" height="60"></a>
            {% endif %}
        </div>

        <h2>{{ article.title|capitalize|raw }}</h2>
        <i>Par {{ article.author|capitalize }}, le {{ article.date|date('d/m/Y') }}</i>

        <div class="well">
            {{ article.content|raw }}
        </div>

        <div class="well">
            {{ include("CMSBlogBundle:Comment:listComment.html.twig") }}
        </div>

        <div class="well">
            {{ include("CMSBlogBundle:Comment:addComment.html.twig") }}
        </div>
        {% if not article.categories.empty %}
            <div class="well">
                <p>Cet article est paru dans les catégories suivantes:
                    {% for category in article.categories %}
                        <a
                        href="{{ path('cms_menu_show_article', {'id': category.id} ) }}">{{ category.name }}</a>{% if not loop.last %}, {% endif %}
                    {% endfor %}
                </p>
            </div>
        {% endif %}
        <p>
            {% if is_granted('ROLE_AUTEUR') %}
                <a href="{{ path('cms_article_list') }}" class="btn btn-success">
                    <i class="glyphicon glyphicon-edit"></i>
                    Retour à la liste
                </a>
                <a href="{{ path('cms_blog_edit', {'id': article.id}) }}" class="btn btn-warning">
                    <i class="glyphicon glyphicon-edit"></i>
                    Modifier l'article
                </a>
                <a href="{{ path('cms_blog_delete', {'id': article.id}) }}" class="btn btn-danger">
                    <i class="glyphicon glyphicon-trash"></i>
                    Supprimer l'article
                </a>
            {% endif %}
        </p>
    {% endif %}
{% endblock %}

